# 目标
- 添加禁卡功能，方便玩家自定义卡池。

# 工作过程
- [DONE] 试用目前其他人已经实现好的卡牌过滤器功能，然后提出适合pvpmod的卡牌过滤器的方案。
	- 结果: 参考了CardFilterMod,卡牌过滤功能的页面类似于百科大全的页面，显示所有的卡牌然后让玩家设置
- [DONE] 实现可自由修改的浏览卡牌页面，后面会基于这个页面做禁牌功能。
	- 状态:
		- [DONE] 找到了用于显示卡牌库的类。
		- [DONE] 将卡牌库放到一个PVP的标准AbstractPage里面。
		- [DONE] 在测试页面添加AbstractPage测试时，open的时候遇到了空指针错误。
			- CardLibraryScreen里面有basemod的patch,因此需要先把它独立出来。
		- [DONE] 将原版游戏中的CardLibraryScreen解耦出来变成一个完全独立的类。
		- [DONE] 由于游戏里面上下文关系，构造CardLibrary的时候需要在特定的位置，所以需要和原版的游戏保持一致。
		- [DONE] 将构造CardFilterScreen的位置放在和PlayerManager一致的地方。
			- 背景: 发现构造位置和原版位置保持一致时会导致进入游戏时报错，这很可能是语言包加载导致的。
			- 结果: 保持构造卡牌的位置一致仍然无法解决问题。
		- [DONE] 删除卡牌页面的语言包加载，改为写死的文本后，可以正常进入游戏了。
		- [DONE] 进入Config页面时仍然会出现闪退，需要另外解决这个问题。
	- 结果:
		- 在Config界面打开时可以看到所有的卡牌。
		- 点击卡牌时会有卡牌放大卡牌的效果。
- [DONE] 添加用于打开禁卡页面的按钮。
	- 状态:
		- [DONE] 在Config页面里面添加了一个新的按钮。
		- [DONE] 实现相关的逻辑，点击这个按钮时打开卡牌浏览界面。
		- [DONE] 实现关闭页面的逻辑，当点击关闭按钮时，需要返回上层页面。
	- 结果:
		- 现在可以在Config页面点击按钮打开卡牌预览界面。
		- 点击界面里面的关闭按钮可以正常关闭界面。
- [DONE] 实现禁用卡牌的UI交互。
	- 结果: 在禁卡界面点击卡牌后，卡牌会变成半透明。
- [DONE] 实现真正意义上的禁用卡牌，确保被禁用的卡牌不会在游戏里出现。
	- 状态:
		- [DONE] 研究往游戏里面加入卡牌的各种入口，最后根据调查结果统一设置一种接口来控制这些卡牌。
			- 所有的卡牌都是在AbstractDungeon里面的initializeCardPool的位置初始化的。
		- [DONE] 实现了卡牌filter的管理器，用于管理哪些卡牌已经被禁用掉了。
		- [DONE] 在initializeCardPool的位置添加后处理patch移除被禁用掉的卡牌。
	- 结果: 现在只要在CardFilter里面设置了卡牌禁用，就可以保证游戏里面不再出现这个卡牌，除非指向性生成。
- [DONE] 将禁卡页面的用户操作链接到禁卡表中。
	- 状态:
		- [DONE] 修改代码逻辑，当点击卡牌库中的卡牌时，修改当前卡牌的禁用状态。
		- [DONE] 实际测试卡牌的禁用效果时，进入商店后遇到了空指针报错，需要解决。
	- 结果: 目前已经可以保证添加到禁卡列表的牌不会出现在游戏中。
- [DONE] 实现卡牌禁用的通信效果，当一方禁用卡牌时，把卡牌禁用的事件传给另一方。
	- 状态:
		- [DONE] 当一方禁用卡牌时，把消息传给另一方。
		- [DONE] 解决卡牌被禁用后的透明效果需要重新打开页面才显示的问题。
			- 背景: 当卡牌通过通信事件被禁用后，它的透明状态需要重新打开禁卡页面才会更新显示。
			- 结果: 打开卡牌预览界面时，忘了更新通信事件了。
		- [DONE] 测试玩家禁用卡牌时的通信效果。
	- 结果: 玩家点击卡牌禁用后，对方可以实时看到卡牌状态的变化。
- [DONE] 添加卡牌禁用界面中返回按钮的文本。
- [TO-DO] 当新玩家刚刚进入房间时，同步目前房间里面的禁用状态。
